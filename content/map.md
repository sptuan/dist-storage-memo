---
title: "é™„ä»¶ï¼šåˆ†å¸ƒå¼å­˜å‚¨çŸ¥è¯†åœ°å›¾"
weight: 900
---


æ ¹æ®ç¬”è€…æ—¥å¸¸å·¥ä½œå¬åˆ°çš„ã€å®é™…ç”¨åˆ°çš„é«˜é¢‘æŠ€æœ¯æ€»ç»“è€Œæˆä¸€å‰¯çŸ¥è¯†åœ°å›¾/æŠ€èƒ½åœ°å›¾ã€‚

è¿™å¼ åœ°å›¾ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ â€œåˆ†å¸ƒå¼å­˜å‚¨æ¼«æ¸¸æŒ‡å—â€ çš„ä¸–ç•Œåœ°å›¾ã€‚

æ³¨ï¼šç¬”è€…å§”æ‰˜ç”»å¸ˆæœ‹å‹æ‰‹å·¥ç»˜åˆ¶è¿™ä¸ªåœ°å›¾ã€‚è¯·å¤§å®¶å°½æƒ…äº«å—æœ€åè¿™å‡ å¹´äººå·¥åˆ›ä½œçš„æ—¥å­å§ï¼

![](https://static.zdfmc.net/imgs/2026/dist-stroage-memo-map_v0.1.0-lite.jpg)
*æ‰‹å·¥ç»˜åˆ¶ä¸æ–­æ›´æ–°ä¸­ï¼Œæ‚¨å¯ä»¥åœ¨[æ­¤é“¾æ¥](https://github.com/sptuan/dist-storage-memo/blob/master/static/dist-stroage-memo-map_v0.1.0-full.png)è·å–é«˜æ¸…ç”µå­ç‰ˆã€‚




## ğŸ—ºï¸ The Map of Distributed Storage


### 1. ç‰©ç†å±‚ä¸ç¡¬ä»¶ (Physical & Hardware)
> è¿™æ˜¯æ‰€æœ‰æ•°æ®çš„æœ€ç»ˆå½’å®¿ï¼Œç‰©ç†ç‰¹æ€§çš„é™åˆ¶å†³å®šäº†ä¸Šå±‚è½¯ä»¶çš„è®¾è®¡ã€‚

#### **å­˜å‚¨ä»‹è´¨**
* **HDD**: æœºæ¢°è‡‚å¯»é“ (**Seek latency**), é¡ºåºå†™ä¼˜åŠ¿, **SMR** (å ç“¦å¼) vs **CMR**ã€‚
* **SSD**: **NAND Flash**, **FTL** (é—ªå­˜è½¬æ¢å±‚), å†™å…¥æ”¾å¤§ (**Write Amplification**), **GC** (åƒåœ¾å›æ”¶)ã€‚
* **New Tech**: **NVMe/ZNS** (åˆ†åŒºå—å­˜å‚¨), **PMEM** (æŒä¹…å†…å­˜), **Open-Channel SSD**ã€‚

#### **ç½‘ç»œç¡¬ä»¶**
* **NIC** (ç½‘å¡), **Switch** (äº¤æ¢æœº), **RDMA** (**InfiniBand/RoCE**)ã€‚

---

### 2. Linux å†…æ ¸ä¸ OS æŠ€èƒ½ (Linux Kernel & OS)
> è¿™æ˜¯å­˜å‚¨å¼€å‘è€…å¿…é¡»æ·±è€•çš„é¢†åŸŸï¼Œç†è§£ OS æ‰èƒ½æ¦¨å¹²ç¡¬ä»¶æ€§èƒ½ã€‚

#### **å†…å­˜ç®¡ç† (Memory)**
* **Page Cache**: Buffered I/O çš„æ ¸å¿ƒï¼Œè„é¡µå›å†™ (**Writeback**), **pdflush**ã€‚
* **NUMA**: éä¸€è‡´æ€§å†…å­˜è®¿é—®ï¼Œè·¨ Socket è®¿é—®çš„æ€§èƒ½é™·é˜± (**CPU Affinity/Binding**)ã€‚
* **Allocators**: **tcmalloc** / **jemalloc** (å‡å°‘å†…å­˜ç¢ç‰‡å’Œé”ç«äº‰)ã€‚

#### **å¹¶å‘ä¸è°ƒåº¦**
* **Context Switches**: ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æˆæœ¬ï¼ˆè‡ªæ—‹é” vs äº’æ–¥é”ï¼‰ã€‚
* **Thread Model**: ç”¨æˆ·æ€çº¿ç¨‹ (**Goroutine**) vs å†…æ ¸çº§çº¿ç¨‹ã€‚

#### **è§‚æµ‹ä¸æ—è·¯**
* **eBPF**: ç°ä»£å†…æ ¸æ— ä¾µå…¥è§‚æµ‹ç¥æŠ€ã€‚
* **Kernel Bypass**: **SPDK**, **DPDK** (ç»•è¿‡å†…æ ¸ç›´æ¥æ“ä½œç¡¬ä»¶ï¼Œæè‡´å‡ä½å»¶è¿Ÿ)ã€‚

---

### 3. æœ¬åœ° I/O æ ˆ (Local I/O Stack)
> æ•°æ®ä»ç”¨æˆ·æ€å†…å­˜æµå‘ç‰©ç†ä»‹è´¨çš„å¿…ç»ä¹‹è·¯ã€‚

#### **VFS (è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ)**
* **Inode / Dentry**: æ–‡ä»¶å¥æŸ„ä¸å…ƒæ•°æ®æŸ¥æ‰¾è¿‡ç¨‹ï¼ˆæµ·é‡å°æ–‡ä»¶çš„æ€§èƒ½ç“¶é¢ˆï¼‰ã€‚
* **Filesystems**: **Ext4** (æ—¥å¿—æœºåˆ¶), **XFS** (å¤§æ–‡ä»¶å¹¶è¡Œæ€§èƒ½), **Btrfs/ZFS** (**CoW**, å¿«ç…§, æ ¡éªŒå’Œ)ã€‚

#### **I/O æ¨¡å¼**
* **Buffered I/O**: æ ‡å‡† `read`/`write`ï¼ˆä¾èµ– Page Cacheï¼‰ã€‚
* **Direct I/O**: `O_DIRECT`, ç»•è¿‡ Page Cacheï¼ˆæ•°æ®åº“/è‡ªç ”å¼•æ“å¸¸ç”¨ï¼‰ã€‚
* **Memory Mapped**: **mmap** (Zero-copy read)ã€‚

#### **é«˜æ€§èƒ½/å¼‚æ­¥æ¥å£**
* **io_uring**: (ç°ä»£é«˜æ€§èƒ½æ ‡å‡†) **Submission/Completion Queue**, **Polling mode**ã€‚
* **Linux AIO**: (æ—§æ—¶ä»£çš„å¼‚æ­¥æ¥å£ï¼Œé™åˆ¶è¾ƒå¤š)ã€‚

---

### 4. å•æœºå­˜å‚¨å¼•æ“ (Local Storage Engine)
> å¦‚ä½•åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šé«˜æ•ˆåœ°ç»„ç»‡æ•°æ®ã€‚å…³é”®æœºåˆ¶ WAL å’Œ Checkpoint å½’ä½äºæ­¤ã€‚

#### **æ•°æ®ç»“æ„**
* **LSM-Tree**: (RocksDB/LevelDB) é€‚åˆå†™å¤šè¯»å°‘ï¼Œæ¶‰åŠ **Compaction**, **Bloom Filter**ã€‚
* **B+ Tree**: (MySQL/BoltDB) é€‚åˆè¯»å¤šå†™å°‘ï¼Œæ¶‰åŠ **Page Split**, **B-Tree å˜ä½“**ã€‚
* **Log-Structured**: (Bitcask) **Append-only**, **Hash Index**ã€‚

#### **å¯é æ€§ç»´æŒæœºåˆ¶ (Durability)**
* **WAL (Write-Ahead Log)**: é¡ºåºå†™ç›˜ä¿å¹³å®‰ï¼Œæ‰€æœ‰çŠ¶æ€å˜æ›´å…ˆå†™æ—¥å¿—ï¼Œ**Crash Recovery** çš„åŸºç¡€ã€‚
* **Checkpoint / Snapshot**: å®šæœŸå°†å†…å­˜çŠ¶æ€æŒä¹…åŒ–ï¼Œç¼©çŸ­æ•…éšœæ¢å¤æ—¶é—´ï¼Œå¸¸ç»“åˆ **CoW** æŠ€æœ¯ã€‚

---

### 5. åˆ†å¸ƒå¼ç†è®ºä¸åè°ƒ (Theory & Coordination)
> è®©ä¸€å †ä¸å¯é çš„æœºå™¨åƒä¸€å°æœºå™¨ä¸€æ ·å·¥ä½œã€‚

#### **ä¸€è‡´æ€§ (Consistency)**
* **Consistency Models**: **Linearizability** (çº¿æ€§ä¸€è‡´æ€§), **Sequential**, **Eventual** (æœ€ç»ˆä¸€è‡´æ€§)ã€‚
* **ç†è®ºåŸºçŸ³**: **CAP å®šç†**, **BASE**, **PACELC** (å»¶è¿Ÿä¸ä¸€è‡´æ€§çš„æƒè¡¡)ã€‚

#### **å…±è¯†ç®—æ³• (Consensus)**
* **Paxos**: åˆ†å¸ƒå¼å…±è¯†çš„åŸºçŸ³ã€‚
* **Raft**: å·¥ä¸šç•Œæœ€æµè¡Œçš„å®ç°ï¼ˆEtcd, TiKVï¼‰ã€‚
* **ZAB**: Zookeeper ä½¿ç”¨çš„åŸå­å¹¿æ’­åè®®ã€‚

#### **æ—¶é’Ÿã€é¡ºåºä¸æ£€æµ‹**
* **Clock**: **Logical Clocks** (Lamport, Vector Clocks), **TrueTime** (åŸå­é’Ÿ)ã€‚
* **Coordination**: **Failure Detection** (å¿ƒè·³æ£€æµ‹), **Lease** (ç§Ÿçº¦æœºåˆ¶é˜²æ­¢è„‘è£‚), **Phi Accrual Detector**ã€‚
* **Leader Election**: é€‰ä¸»æœºåˆ¶ã€‚

---

### 6. æ•°æ®åˆ†å¸ƒä¸å…ƒæ•°æ® (Distribution & Metadata)
> å†³å®šæ•°æ®åˆ‡åˆ†åˆ°å“ªé‡Œï¼Œä»¥åŠå¦‚ä½•ä¿è¯ä¸ä¸¢ã€‚

#### **åˆ†ç‰‡ç­–ç•¥ (Sharding)**
* **Partitioning**: **Range Sharding** (æŒ‰èŒƒå›´), **Hash Sharding**ã€‚
* **Consistent Hashing**: (ä¸€è‡´æ€§å“ˆå¸Œ & è™šæ‹ŸèŠ‚ç‚¹) è§£å†³èŠ‚ç‚¹å¢å‡æ—¶çš„æ•°æ®è¿ç§»é—®é¢˜ã€‚

#### **å†—ä½™ç­–ç•¥ (Redundancy)**
* **Replication**: **Multi-Raft**, **Chain Replication**, **Primary-Backup**ã€‚
* **Erasure Coding (EC)**: **RS Codes**, **LRC** (å±€éƒ¨é‡æ„ç ï¼Œé™ä½è·¨æœºæŸœä¿®å¤å¸¦å®½)ã€‚

#### **å…ƒæ•°æ®ç®¡ç†**
* **Management**: **Centralized** (HDFS NameNode), **Decentralized** (DHT/Kademlia), **Federation**ã€‚

---

### 7. æ¶æ„å½¢æ€ (Architecture & API)
> ç”¨æˆ·çœ‹åˆ°çš„ç³»ç»Ÿå½¢æ€ä¸è®¿é—®åè®®ã€‚

#### **æ¥å£å½¢æ€**
* **Block (å—å­˜å‚¨)**: **Ceph**, **OpenEBS**ã€‚
* **File (æ–‡ä»¶å­˜å‚¨)**: **NFS**, **CephFS**, **JuiceFS** (ç¬¦åˆ POSIX æ ‡å‡†)ã€‚
* **Object (å¯¹è±¡å­˜å‚¨)**: **S3 API** (äº‹å®æ ‡å‡†), **MinIO**ã€‚

#### **ç³»ç»Ÿæ¶æ„æ¼”è¿›**
* **Shared-Nothing**: ä¼ ç»Ÿåˆ†å¸ƒå¼æ¶æ„ã€‚
* **Disaggregated Storage (å­˜ç®—åˆ†ç¦»)**: äº‘åŸç”Ÿå¤§è¶‹åŠ¿ï¼Œè®¡ç®—å±‚æ— çŠ¶æ€ï¼Œå­˜å‚¨å±‚ç‹¬ç«‹æ‰©å±•ã€‚

---

### 8. å·¥ç¨‹åŒ–ä¸å¯é æ€§ (Engineering & Reliability)
> å¼€å‘è€…çš„å·¥å…·ç®±ï¼Œç¡®ä¿ç³»ç»Ÿåœ¨æ··æ²Œçš„ç¯å¢ƒä¸­ä¾ç„¶æ­£ç¡®ã€‚

#### **æ­£ç¡®æ€§éªŒè¯**
* **Formal Methods**: **TLA+** (å½¢å¼åŒ–éªŒè¯å¤æ‚ç®—æ³•é€»è¾‘)ã€‚
* **Testing**: **Jepsen Test** (åˆ†å¸ƒå¼ä¸€è‡´æ€§é»‘ç›’æµ‹è¯•)ã€‚

#### **æ··æ²Œå·¥ç¨‹ä¸è§‚æµ‹**
* **Chaos Engineering**: **Fault Injection** (æ•…éšœæ³¨å…¥), **Chaos Mesh**ã€‚
* **Observability**: **Distributed Tracing** (OpenTelemetry), **Tail Latency Analysis** (P99/P999 å»¶è¿Ÿåˆ†æ)ã€‚
